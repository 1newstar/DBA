# DTS 传输速率

[TOC]



> 根据公司做过的项目进行的总结

**根据阿里官方资料及与技术人员沟通，DTS服务对源实例的压力上，没有具体的占比，其影响取决于多个方面，包括：**

1）DTS不同的实例规格

2）RDS源实例规格

3）RDS源实例实际并发数

4）RDS目标实例规格

根据驻云丰富的经验，DTS对源数据库的影响主要在I/O上面，而对CPU、连接数、磁盘空间影响甚小。因此需要提前做好预防，以减小DTS同步服务对生产环境的影响规避风险。

| 案例     | 传输速率   | IOPS-正常 | IOPS-迁移中 | 上涨比   | 源IOPS MAX |
| ------ | ------ | ------- | -------- | ----- | --------- |
| 案例1-内网 | 30G/h  | 14      | 220      | 1400% | 4000      |
| 案例2-外网 | 5G/h   | 28      | 990      | 3418% | 无         |
| 案例3-内网 | 32G/h  | 150     | 600      | 3000% | 600       |
| 案例4-内网 | 1.3G/h | 10      | 180      | 1700% | 600       |

## 速率参考表

| DTS服务 | 类型   | 跨云   | 跨区域  | 跨网络  | 传输途径 | 参考速度 | 案例1         | 案例2        | 案例3  |
| ----- | ---- | ---- | ---- | ---- | ---- | ---- | ----------- | ---------- | ---- |
| dts迁移 | A    | no   | no   | no   | 内网   |      | 114G/h 快宝网络 | 30G/h 虹越花卉 |      |
|       | B    | no   | no   | yes  | 内网   |      | 10G/h心仪物流   |            |      |
|       | C    | no   | yes  | no   | 外网   |      |             |            |      |
|       | D    | no   | yes  | yes  | 外网   |      | 1G/h 大脑地图   | 15.7G/h巨昂  |      |
|       | E    | yes  | no   | no   | 内网   |      |             |            |      |
|       | F    | yes  | no   | yes  | 内网   |      |             |            |      |
|       | G    | yes  | yes  | no   | 外网   |      |             |            |      |
|       | H    | yes  | yes  | yes  | 外网   |      |             |            |      |

| DTS服务 | 类型   | 跨云   | 跨区域  | 跨网络  | 传输途径 | 参考速度     | 案例1           | 案例2             | 案例3  |
| ----- | ---- | ---- | ---- | ---- | ---- | -------- | ------------- | --------------- | ---- |
| dts同步 | A    | no   | no   | no   | 内网   |          |               |                 |      |
|       | B    | no   | no   | yes  | 内网   |          |               |                 |      |
|       | C    | no   | yes  | no   | 内网   |          |               |                 |      |
|       | D    | no   | yes  | yes  | 内网   |          |               |                 |      |
|       | E    | yes  | no   | no   | 内网   |          |               |                 |      |
|       | F    | yes  | no   | yes  | 内网   | 30~50G/h | 32G/h 梧桐金融测试库 | 95.17G/h梧桐金融生产库 |      |
|       | G    | yes  | yes  | no   | 内网   |          |               |                 |      |
|       | H    | yes  | yes  | yes  | 内网   |          |               |                 |      |



阿里给出的所谓加速是适当提升源库或者目标库的配置，以提升同步速度，但提升的比例是无法量化的。

## 案例

### DTS迁移案例



#### A-虹越花卉

| 源库规格       | 公有云 VPC 华东1  8核\16G\50G\4000IOPS mysql5.5 |
| ---------- | ---------------------------------------- |
| 目标库规格      | 公有云 VPC 华东1  2核\4G\50G\1200IOPS mysql5.6 |
| 数据量        | 17.13G                                   |
| DTS规格      | Large                                    |
| 迁移时间       | 34分钟                                     |
| 迁移速度       | 30G/h                                    |
| 源库IOPS上涨比例 | 1400%（14-220）                            |

#### B-心怡物流

> 该客户function：90，procedures：4558，同步存储过程的时候很慢，因为需要检查语法 

| 源库规格       | 公有云 经典网络 华东1  10核\6G\50G\8000IOPS mysql5.5 |
| ---------- | ---------------------------------------- |
| 目标库规格      | 公有云 VPC 华东1  8核\16G\50G\8000IOPS mysql5.5 |
| 数据量        | 20G                                      |
| DTS规格      | Large                                    |
| 迁移时间       | 2小时                                      |
| 迁移速度       | 10G/h                                    |
| 源库IOPS上涨比例 | 1400%（14-220）                            |

#### D-大脑地图

| 源库规格     | 公有云 经典 华东1（可用区D）  4核\32G\5Mbps     ecs   |
| -------- | ---------------------------------------- |
| 目标库规格    | 公共云 vpc 华东1 （可用区E） 4核\16G\200G\7000IOPS mysql5.6 |
| 数据量      | 175G                                     |
| DTS规格    | Large                                    |
| 迁移时间     | 35h                                      |
| 迁移速度     | 5G/h                                     |
| 源库IO上涨比例 | 3418%（28.15-990.21kb/s）                  |

### D-巨昂

| 源库规格     | 公有云 经典 华北1（可用区D）  8核\16G\8Mbps     ecs windows |
| -------- | ---------------------------------------- |
| 目标库规格    | 公共云 vpc 华东2 （可用区E） 8核\16G\500G\8000IOPS mysql5.6 |
| 数据量      | 142G                                     |
| DTS规格    | Large                                    |
| 迁移时间     | 9h                                       |
| 迁移速度     | 15.7G/h                                  |
| 源库IO上涨比例 |                                          |

### B-速珂m4u预发布迁移总结

> 2017-12-04 11:06~11:20

| 源库规格  | 公有云 经典 华北1  1核/4G centos 6.5 64位 mysql5.7 |
| ----- | ---------------------------------------- |
| 目标库规格 | 公共云 vpc 华北1 2核/4G centos 6.5 64位 mysql5.7 |
| 数据量   | 995M                                     |
| DTS规格 | Large                                    |
| 迁移时间  | 12min                                    |
| 迁移速度  | 4.8G/h                                   |



### B-速珂www官网迁移总结

> 2017-12-04 13:48~13:57

| 源库规格  | 公有云 经典 华北1  1核/4G centos 6.5 64位 mysql5.7 |
| ----- | ---------------------------------------- |
| 目标库规格 | 公共云 vpc 华北1 2核/4G centos 6.5 64位 mysql5.7 |
| 数据量   | 1.1G                                     |
| DTS规格 | Large                                    |
| 迁移时间  | 9min                                     |
| 迁移速度  | 7.3G/h                                   |



### DTS同步服务

####  F-梧桐金融测试库

| 源库规格       | 公有云 经典 华东1   6核\1G\800G\600IOPS mysql5.6 |
| ---------- | ---------------------------------------- |
| 目标库规格      | 金融云 VPC 华东2    8核\64G\1000G\10000IOPS mysql5.6 |
| 数据量        | 420G                                     |
| DTS规格      | Large                                    |
| 迁移时间       | 13小时28分钟                                 |
| 迁移速度       | 31G/h                                    |
| 源库IOPS上涨比例 | 3000%（150-600）                           |



#### F-梧桐金融生产库

| 源库规格       | 公有云 经典 华东1   11核\24G\800G\12000IOPS mysql5.6 |
| ---------- | ---------------------------------------- |
| 目标库规格      | 金融云 VPC  华东2     8核\64G\1000G\10000IOPS mysql5.6 |
| 数据量        | 523.44G                                  |
| DTS规格      | Large                                    |
| 迁移时间       | 5.5小时                                    |
| 迁移速度       | 95.17G/h                                 |
| 源库IOPS上涨比例 | 1150%（91.04~1138.91）                     |